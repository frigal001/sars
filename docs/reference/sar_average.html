<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a multimodel averaged SAR curve — sar_average • sars</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fit a multimodel averaged SAR curve — sar_average" />

<meta property="og:description" content="Construct a multimodel averaged species-area relationship curve
  using information criterion weights and up to twenty SAR models." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sars</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sars-r-package.html">sars R Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/txm676/sars">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a multimodel averaged SAR curve</h1>
    <small class="dont-index">Source: <a href='https://github.com/txm676/sars/blob/master/R/sar_average.R'><code>R/sar_average.R</code></a></small>
    <div class="hidden name"><code>sar_average.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Construct a multimodel averaged species-area relationship curve
  using information criterion weights and up to twenty SAR models.</p>
    
    </div>

    <pre class="usage"><span class='fu'>sar_average</span>(<span class='kw'>obj</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"power"</span>,
  <span class='st'>"powerR"</span>,<span class='st'>"epm1"</span>,<span class='st'>"epm2"</span>,<span class='st'>"p1"</span>,<span class='st'>"p2"</span>,<span class='st'>"loga"</span>,<span class='st'>"koba"</span>,
  <span class='st'>"mmf"</span>,<span class='st'>"monod"</span>,<span class='st'>"negexpo"</span>,<span class='st'>"chapman"</span>,<span class='st'>"weibull3"</span>,<span class='st'>"asymp"</span>,
  <span class='st'>"ratio"</span>,<span class='st'>"gompertz"</span>,<span class='st'>"weibull4"</span>,<span class='st'>"betap"</span>,<span class='st'>"heleg"</span>, <span class='st'>"linear"</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>crit</span>
  <span class='kw'>=</span> <span class='st'>"Info"</span>, <span class='kw'>normaTest</span> <span class='kw'>=</span> <span class='st'>"lillie"</span>, <span class='kw'>homoTest</span> <span class='kw'>=</span> <span class='st'>"cor.fitted"</span>, <span class='kw'>neg_check</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>alpha_normtest</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>alpha_homotest</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>confInt</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ciN</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>verb</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>Either a vector of model names or a fit_collection object created
using <code><a href='sar_multi.html'>sar_multi</a></code>. If a vector of names is provided,
<code>sar_average</code> first calls <code>sar_multi</code> before generating the
averaged multimodel curve.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A dataset in the form of a dataframe with two columns: the first
with island/site areas, and the second with the species richness of each
island/site. If <code>obj</code> is a fit_collection object, <code>data</code> should
be NULL.</p></td>
    </tr>
    <tr>
      <th>crit</th>
      <td><p>The criterion used to compare models and compute the model
weights. The default <code>crit = "Info"</code> switches to AIC or AICc depending
on the number of data points in the dataset. AIC (<code>crit = "AIC"</code>) or
AICc (<code>crit = "AICc"</code>) can be chosen regardless of the sample size. For
BIC, use <code>crit ="Bayes"</code>.</p></td>
    </tr>
    <tr>
      <th>normaTest</th>
      <td><p>The test used to test the normality of the residuals of each
model. Can be any of "lillie" (Lilliefors Kolmogorov-Smirnov test; the
default), "shapiro" (Shapiro-Wilk test of normality), "kolmo"
(Kolmogorov-Smirnov test), or "none" (no residuals normality test is
undertaken).</p></td>
    </tr>
    <tr>
      <th>homoTest</th>
      <td><p>The test used to check for homogeneity of the residuals of
each model. Can be any of "cor.fitted" (a correlation of the residuals with
the model fitted values; the default), "cor.area" (a correlation of the
residuals with the area values), or "none" (no residuals homogeneity test
is undertaken).</p></td>
    </tr>
    <tr>
      <th>neg_check</th>
      <td><p>Whether or not a check should be undertaken to flag any
models that predict negative richness values.</p></td>
    </tr>
    <tr>
      <th>alpha_normtest</th>
      <td><p>The alpha value used in the residual normality test
(default = 0.05, i.e. any test with a P value &lt; 0.05 is flagged as failing
the test).</p></td>
    </tr>
    <tr>
      <th>alpha_homotest</th>
      <td><p>The alpha value used in the residual homogeneity test
(default = 0.05, i.e. any test with a P value &lt; 0.05 is flagged as failing
the test).</p></td>
    </tr>
    <tr>
      <th>confInt</th>
      <td><p>A logical argument specifying whether confidence intervals
should be calculated for the multimodel curve using bootstrapping.</p></td>
    </tr>
    <tr>
      <th>ciN</th>
      <td><p>The number of bootstrap samples to be drawn to calculate the
confidence intervals (if <code>confInt == TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>verb</th>
      <td><p>verbose (default: <code>verb == TRUE</code>).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class "multi" and class "sars" with two elements. The first
  element ('mmi') contains the fitted values of the multimodel sar curve. The
  second element ('details') is a list with the following components:</p><ul>
<li><p>mod_names  Names of the models that were successfully
  fitted and passed any model check</p></li>
<li><p>fits  A fit_collection object
  containing the successful model fits</p></li>
<li><p>ic  The information criterion
  selected</p></li>
<li><p>norm_test  The residual normality test selected</p></li>
<li><p>homo_test  The residual homogeneity test selected</p></li>
<li><p>alpha_norm_test  The alpha value used in the residual normality
  test</p></li>
<li><p>alpha_homo_test  The alpha value used in the residual
  homogeneity test</p></li>
<li><p>ics  The information criterion values (e.g. AIC
  values) of the model fits</p></li>
<li><p>delta_ics  The delta information
  criterion values</p></li>
<li><p>weights_ics  The information criterion weights of
  each model fit</p></li>
<li><p>n_points   Number of data points</p></li>
<li><p>n_mods 
  The number of successfully fitted models</p></li>
<li><p>no_fit  Names of the
  models which could not be fitted or did not pass model checks</p></li>
</ul>

<p>The <code><a href='summary.sars.html'>summary.sars</a></code> function returns a more useful summary of
  the model fit results, and the <code><a href='plot.multi.html'>plot.multi</a></code> plots the
  multimodel curve.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The multimodel SAR curve is constructed using information criterion
  weights (see Burnham &amp; Anderson, 2002; Guilhaumon et al. 2010). If
  <code>obj</code> is a vector of n model names the function fits the n models to
  the dataset provided using the <code>sar_multi</code> function. A dataset must
  have four or more datapoints to fit the multimodel curve. If any models
  cannot be fitted they are removed from the multimodel SAR. If <code>obj</code> is
  a fit_collection object (created using the <code>sar_multi</code> function), any
  model fits in the collection which are NA are removed. In addition, if any
  other model checks have been selected (i.e. residual normality and
  heterogeneity tests, and checks for negative predicted richness values),
  these are undertaken and any model that fails the selected test(s) is
  removed from the multimodel SAR. The order of the additional checks inside
  the function is: normality of residuals, homogeneity of residuals, and a
  check for negative fitted values. Once a model fails one test it is removed
  and thus is not available for further tests. Thus, a model may fail
  multiple tests but the returned warning will only provide information on a
  single test.</p>
<p>The resultant models are then used to construct the multimodel SAR curve.
  For each model in turn, the model fitted values are multiplied by the
  information criterion weight of that model, and the resultant values are
  summed across all models (Burnham &amp; Anderson, 2002). Confidence intervals
  can be calculated (using <code>confInt</code>) around the multimodel averaged
  curve using the bootstrap procedure outlined in Guilhaumon et al (2010).The
  procedure transforms the residuals from the individual model fits and
  occasionally NAs / Inf values can be produced - in these cases, the model
  is removed from the confidence interval calculation (but not the multimodel
  curve itself). When several SAR models are used and the number of
  bootstraps (<code>ciN</code>) is large, generating the confidence intervals can
  take a long time.</p>
<p>The <code>sar_models()</code> function can be used to bring up a list of the 20
  model names. <code><a href='display_sars_models.html'>display_sars_models()</a></code> generates a table of the 20
  models with model information.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Occasionally a model fit will converge and pass the model fitting
  checks (e.g. residual normality) but the resulting fit is nonsensical (e.g.
  a horizontal line with intercept at zero). Thus, it can be useful to plot
  the resultant 'multi' object to check the individual model fits. To re-run
  the <code>sar_multi</code> function without a particular model, simply remove it
  from the <code>obj</code> argument.</p>
<p>The generation of confidence intervals around the multimodel curve (using
  <code>confInt == TRUE</code>), may throw up errors that we have yet to come
  across. Please report any issues to the package maintainer.</p>  
<p>There are different formulas for calculating the various information
  criteria (IC) used for model comparison (e.g. AIC, BIC). For example, some
  formulas use the residual sum of squares (rss) and others the
  log-likelihood (ll). Both are valid approaches and will give the same
  parameter estimates, but it is important to only compare IC values that
  have been calculated using the same approach. For example, the 'sars'
  package used to use formulas based the rss, while the <a href='https://www.rdocumentation.org/packages/stats/topics/nls'>nls</a>
  function function in the stats package uses formulas based on the ll. To
  increase the compatability between nls and sars, we have changed our
  formulas such that now our IC formulas are the same as those used in the
  <a href='https://www.rdocumentation.org/packages/stats/topics/nls'>nls</a> function. See the "On the calculation of information
  criteria" section in the package vignette for more information.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Burnham, K. P., &amp; Anderson, D. R. (2002). Model selection and
  multi-model inference: a practical information-theoretic approach (2nd
  ed.). New-York: Springer.</p>
<p>Guilhaumon, F., Mouillot, D., &amp; Gimenez, O. (2010). mmSAR: an R-package for
  multimodel species-area relationship inference. Ecography, 33, 420-424.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>galap</span>)
<span class='co'>#attempt to construct a multimodel SAR curve using all twenty sar models</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>sar_average</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>galap</span>)</div><div class='output co'>#&gt; 
#&gt;  Now attempting to fit the 20 SAR models: 
#&gt; 
#&gt; --  multi_sars --------------------------- multi-model SAR --
#&gt; &gt; power    : v
#&gt; &gt; powerR   : v
#&gt; &gt; epm1     : v
#&gt; &gt; epm2     : v
#&gt; &gt; p1       : v
#&gt; &gt; p2       : v
#&gt; &gt; loga     : v
#&gt; &gt; koba     : v
#&gt; &gt; mmf      : v
#&gt; &gt; monod    : v
#&gt; &gt; negexpo  : v
#&gt; &gt; chapman  : Warning: could not compute parameters statistics
#&gt; &gt; weibull3 : v
#&gt; &gt; asymp    : v
#&gt; &gt; ratio    : v
#&gt; &gt; gompertz : v
#&gt; &gt; weibull4 : v
#&gt; &gt; betap    : v
#&gt; &gt; heleg    : v
#&gt; &gt; linear   : v
#&gt; 
#&gt; Model fitting completed - all models succesfully fitted.  Now undertaking model validation checks.
#&gt; Additional models  will be excluded if necessary:</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>4 models failed the residuals normality test and  have been excluded  from the multi SAR:</span>
#&gt; <span class='message'>Extended Power model 1, Asymptotic regression, Cumulative Weibull 4 par., Linear model</span></div><div class='output co'>#&gt; 16 remaining models used to construct the multi  SAR:
#&gt;  Power, PowerR, Extended Power model 2, Persistence function 1, Persistence function 2, Logarithmic, Kobayashi, MMF, Monod, Negative exponential, Chapman Richards, Cumulative Weibull 3 par., Rational function, Gompertz, Beta-P cumulative, Heleg(Logistic) 
#&gt; -------------------------------------------------------------</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; 
#&gt; Sar_average object summary:
#&gt; 
#&gt; 16  models successfully fitted
#&gt; 
#&gt; The following models could not be fitted or were  removed due to model checks:
#&gt; Extended Power model 1, Asymptotic regression, Cumulative Weibull 4 par., Linear model 
#&gt; 
#&gt; Ranked models based on AICc  weights:
#&gt; 
#&gt;       Model Weight    AICc    R2   R2a     Shape Asymptote
#&gt; 1   negexpo  0.219 186.832 0.557 0.488 convex up      TRUE
#&gt; 2     monod  0.178 187.246 0.545 0.475 convex up      TRUE
#&gt; 3      koba  0.118 188.073 0.521 0.447 convex up     FALSE
#&gt; 4     power  0.073 189.031 0.491 0.413 convex up     FALSE
#&gt; 5      loga  0.067 189.191 0.486 0.407 convex up     FALSE
#&gt; 6        p1  0.066 189.246 0.589 0.486 convex up     FALSE
#&gt; 7  gompertz  0.061 189.393 0.585 0.482 convex up      TRUE
#&gt; 8  weibull3  0.038 190.324 0.561 0.451 convex up      TRUE
#&gt; 9   chapman  0.036 190.468 0.557 0.446 convex up      TRUE
#&gt; 10    ratio  0.035 190.494 0.556 0.445 convex up      TRUE
#&gt; 11    heleg  0.029 190.882 0.545 0.431 convex up      TRUE
#&gt; 12      mmf  0.029 190.882 0.545 0.431 convex up      TRUE
#&gt; 13       p2  0.019 191.712 0.521 0.401 convex up     FALSE
#&gt; 14   powerR  0.014 192.283 0.503 0.379 convex up     FALSE
#&gt; 15     epm2  0.014 192.329 0.502 0.377   sigmoid     FALSE
#&gt; 16    betap  0.002 196.018 0.522 0.349 convex up     FALSE</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='sar_average-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># construct a multimodel SAR curve using a fit_collection object</span>
<span class='no'>ff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sar_multi.html'>sar_multi</a></span>(<span class='no'>galap</span>, <span class='kw'>obj</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"power"</span>, <span class='st'>"loga"</span>, <span class='st'>"monod"</span>, <span class='st'>"weibull3"</span>))</div><div class='output co'>#&gt; 
#&gt;  Now attempting to fit the 4 SAR models: 
#&gt; 
#&gt; --  multi_sars --------------------------- multi-model SAR --
#&gt; &gt; power    : v
#&gt; &gt; loga     : v
#&gt; &gt; monod    : v
#&gt; &gt; weibull3 : v</div><div class='input'><span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'>sar_average</span>(<span class='kw'>obj</span> <span class='kw'>=</span> <span class='no'>ff</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</div><div class='output co'>#&gt; 
#&gt; Now undertaking model validation checks. Additional models  will
#&gt; be excluded if necessary
#&gt; 
#&gt; All models passed the model  validation checks
#&gt; 
#&gt; 4 remaining models used to construct the multi  SAR:
#&gt;  Power, Logarithmic, Monod, Cumulative Weibull 3 par. 
#&gt; -------------------------------------------------------------</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit2</span>)</div><div class='output co'>#&gt; 
#&gt; Sar_average object summary:
#&gt; 
#&gt; 4  models successfully fitted
#&gt; 
#&gt; All models were fitted successfully
#&gt; 
#&gt; Ranked models based on AICc  weights:
#&gt; 
#&gt;      Model Weight    AICc    R2   R2a     Shape Asymptote
#&gt; 1    monod  0.499 187.246 0.545 0.475 convex up      TRUE
#&gt; 2    power  0.205 189.031 0.491 0.413 convex up     FALSE
#&gt; 3     loga  0.189 189.191 0.486 0.407 convex up     FALSE
#&gt; 4 weibull3  0.107 190.324 0.561 0.451 convex up      TRUE</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thomas J. Matthews, Francois Guilhaumon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

