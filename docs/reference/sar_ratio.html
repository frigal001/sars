<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit the Rational function model — sar_ratio • sars</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fit the Rational function model — sar_ratio" />

<meta property="og:description" content="Fit the Rational function model to SAR data." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sars</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sars-r-package.html">sars R Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/txm676/sars">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit the Rational function model</h1>
    <small class="dont-index">Source: <a href='https://github.com/txm676/sars/blob/master/R/sar_ratio.R'><code>R/sar_ratio.R</code></a></small>
    <div class="hidden name"><code>sar_ratio.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fit the Rational function model to SAR data.</p>
    
    </div>

    <pre class="usage"><span class='fu'>sar_ratio</span>(<span class='no'>data</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>grid_start</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>normaTest</span> <span class='kw'>=</span>  <span class='st'>'lillie'</span>,
  <span class='kw'>homoTest</span> <span class='kw'>=</span> <span class='st'>'cor.fitted'</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A dataset in the form of a dataframe with two columns: 
the first with island/site areas, and the second with the species richness
of each island/site.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>NULL or custom parameter start values for the optimisation algorithm.</p></td>
    </tr>
    <tr>
      <th>grid_start</th>
      <td><p>NULL or the number of points sampled in the model parameter space
or FALSE to prevent any grid start after a fail in initial optimization
to run a grid search.</p></td>
    </tr>
    <tr>
      <th>normaTest</th>
      <td><p>The test used to test the normality of the residuals of the
model. Can be any of 'lillie' (Lilliefors Kolmogorov-Smirnov test; the
default), 'shapiro' (Shapiro-Wilk test of normality), 'kolmo'
(Kolmogorov-Smirnov test), or 'none' (no residuals normality test is undertaken).</p></td>
    </tr>
    <tr>
      <th>homoTest</th>
      <td><p>The test used to check for homogeneity of the residuals of
the model. Can be any of 'cor.fitted' (a correlation of the residuals with
the model fitted values; the default), 'cor.area' (a correlation of the
residuals with the area values), or 'none' (no residuals homogeneity test is undertaken).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class 'sars' with the following components:</p><ul>
<li><p>par  The model parameters</p></li>
<li><p>value  Residual sum of squares</p></li>
<li><p>counts   The number of iterations for the convergence of the fitting algorithm</p></li>
<li><p>convergence  Numeric code indicating model convergence (0 = converged)</p></li>
<li><p>message  Any message from the model fit algorithm</p></li>
<li><p>hessian  A symmetric matrix giving an estimate of the Hessian at the solution found</p></li>
<li><p>verge  Logical code indicating model convergence</p></li>
<li><p>startValues  The start values for the model parameters used in the optimisation</p></li>
<li><p>data  Observed data</p></li>
<li><p>model  A list of model information (e.g. the model name and formula)</p></li>
<li><p>calculated   The fitted values of the model</p></li>
<li><p>residuals  The model residuals</p></li>
<li><p>AIC  The AIC value of the model</p></li>
<li><p>AICc  The AICc value of the model</p></li>
<li><p>BIC  The BIC value of the model</p></li>
<li><p>R2  The R2 value of the model</p></li>
<li><p>R2a  The adjusted R2 value of the model</p></li>
<li><p>sigConf  The model coefficients table</p></li>
<li><p>normaTest  The results of the residuals normality test</p></li>
<li><p>homoTest  The results of the residuals homogeneity test</p></li>
<li><p>observed_shape  The observed shape of the model fit</p></li>
<li><p>asymptote  A logical value indicating whether the observed fit is asymptotic</p></li>
<li><p>neg_check  A logical value indicating whether negative fitted values have been returned</p></li>
</ul><p>The <code><a href='summary.sars.html'>summary.sars</a></code> function returns a more useful summary of
  the model fit results, and the <code><a href='plot.sars.html'>plot.sars</a></code> plots the model fit.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The model is fitted using non-linear regression. The model parameters are estimated
  by minimizing the residual sum of squares with an unconstrained Nelder-Mead optimization algorithm
  and the <code><a href='https://www.rdocumentation.org/packages/stats/topics/optim'>optim</a></code> function. To avoid numerical problems and speed up the convergence process,
  the starting values used to run the optimization algorithm are carefully chosen, or custom values can be provided
  using the argument <code>start</code>. The fitting process also determines the observed shape of the model fit,
  and whether or not the observed fit is asymptotic (see Triantis et al. 2012 for further details).
  Model validation is undertaken by assessing the normality (<code>normaTest</code>) and homogeneity (<code>homoTest</code>)
  of the residuals and a warning is provided in <code><a href='summary.sars.html'>summary.sars</a></code> if either test is failed.
  A selection of information criteria (e.g. AIC, BIC) are returned and can be used to compare models
  (see also <code><a href='sar_average.html'>sar_average</a></code>)</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Triantis, K.A., Guilhaumon, F. &amp; Whittaker, R.J. (2012) The island species-area
  relationship: biology and statistics. Journal of Biogeography, 39, 215-231.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>galap</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>sar_ratio</span>(<span class='no'>galap</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; 
#&gt; Model:
#&gt; Rational function
#&gt; 
#&gt; Call: 
#&gt; S == (c + z * A)/(1 + d * A)
#&gt; 
#&gt; Did the model converge: TRUE
#&gt; 
#&gt; Residuals:
#&gt;       0%      25%      50%      75%     100% 
#&gt; -149.900  -24.575    6.300   23.550  128.500 
#&gt; 
#&gt; Parameters:
#&gt;     Estimate Std. Error    t value   Pr(&gt;|t|)       2.5%   97.5%
#&gt; c  20.088864  36.491012   0.550515   0.591301 -52.893160 93.0709
#&gt; z   3.485245   3.505517   0.994217   0.338263  -3.525788 10.4963
#&gt; d   0.015293   0.017702   0.863873   0.403316  -0.020112  0.0507
#&gt; 
#&gt; R-squared: 0.56, Adjusted R-squared: 0.44
#&gt; AIC: 186.86, AICc: 190.49, BIC: 189.95
#&gt; Observed shape: convex up, Asymptote: TRUE
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='sar_ratio-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thomas J. Matthews, Francois Guilhaumon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

